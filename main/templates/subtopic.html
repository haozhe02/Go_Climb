<!-- /*
* Bootstrap 5
* Template Name: Furni
* Template Author: Untree.co
* Template URI: https://untree.co/
* License: https://creativecommons.org/licenses/by/3.0/
*/ -->
{% load static %}
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="author" content="Untree.co">
  <link rel="shortcut icon" href="{% static '/images/GoClimb Logo 50px.png' %}">

  <meta name="description" content="" />
  <meta name="keywords" content="bootstrap, bootstrap4" />

		<!-- Bootstrap CSS -->
		<link href="{% static '/css/bootstrap.min.css' %}" rel="stylesheet">
		<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
		<!--<link href="{% static '/css/tiny-slider.css' %}" rel="stylesheet">-->
		<link href="{% static '/css/style.css' %}" rel="stylesheet" type="text/css">
		<link href="{% static '/css/forum.css' %}" rel="stylesheet">
		<title>Sub Topic</title>

		<style>
			#reactions th, #reactions td{
				border: 5px solid white;
				padding: 2px;
			}
		</style>
	
	</head>

	<body>

		<!-- Start Header/Navigation -->
		<nav class="custom-navbar navbar navbar navbar-expand-md navbar-dark bg-dark" arial-label="Furni navigation bar">

			<div class="container">
				<div class="hero-img-wrap">
					<img src="{% static 'images/GoClimb Logo 50px.png'%}" class="img-fluid">
				</div>

				<span>&nbsp;&nbsp;&nbsp;</span>
			
				<a class="navbar-brand" href="/home" style="color: #F5F0BB;">GoClimb<span>.</span></a>

				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsFurni" aria-controls="navbarsFurni" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>

				<div class="collapse navbar-collapse" id="navbarsFurni">
					<ul class="custom-navbar-nav navbar-nav ms-auto mb-2 mb-md-0">
						<li>
							<a class="nav-link" href="/home">Home</a>
						</li>
						<li><a class="nav-link" href="/weather">Weather</a></li>
						<li><a class="nav-link" href="/ARroute">AR Route</a></li>
						<li class="active"><a class="nav-link" href="/forum">Forum</a></li>
						<li><a class="nav-link" href="/search">Search Crags</a></li>
						<li><a class="nav-link" href="/contact">Contact us</a></li>
						{% if user.account.is_admin %}
						<li><a class="nav-link" href="/adminPortal">Admin</a></li>
						{% endif %}
					</ul>

					<ul class="custom-navbar-cta navbar-nav mb-2 mb-md-0 ms-5">
						<li style="margin-right: 5px;"><a class="nav-link" href="/profile"><img src="{% static 'images/user.svg' %}"></a></li>
						<!-- <li><a class="nav-link" href="cart.html"><img src="images/cart.svg"></a></li> -->
                        {% if user.is_authenticated %}
						<li>
							<a class="nav-link" href="/notifications"><img src="{% static 'images/envelope-outline.svg'%}"></a></li>
						</li>
						<li>
							<button id="emergency" style="background: transparent; border: none; padding: 8px; cursor: pointer;"><img width="30" src="{% static 'images/emergency-icon.png'%}" alt="Call Emergency"/></button>
						</li>
						<li>
							<p><a href="/logout" class="btn btn-secondary me-2">Logout</a>
						</li>
						{% endif %}
					</ul>
				</div>
			</div>
				
		</nav>
		<!-- End Header/Navigation -->

		<!-- Start Hero Section -->
			<div class="hero">
				<div class="container">
					<div class="row justify-content-between">
						<div class="col-lg-5">
							<div class="intro-excerpt">
								<a href="/subtopic/{{subtopic.id}}"><h1>Sub Topic - {{subtopic.title}}</h1></a>
								<button class="share-button" data-subtopic-link="{% url 'subtopic' id=subtopic.id %}" style="border-radius: 40px; margin: auto;height:40px;text-align: center;background-color:#B3C890; border: none;">
									Share This Sub Topic</button>
							</div>
						</div>
					</div>
				</div>
			</div>
		<!-- End Hero Section -->

		<!-- Start forum -->
		<!-- <div class="forum-center"></div>
			<div class="forum-left">
				<div class="forum-topic-card">
					<h3>Forum</h3>
					<a class="nav-link" href="#"><img src="images/user-profile-icon.png" height="40px"></a></li>
					<div class="details">
						<p>@user_name <br> Country of Origin <br>0 Followers &nbsp; 0 Following</p>
					</div>
				</div>
				<div class="forum-topic-card">
					<div class="favourite-activities">
						<h3>Favourite Activites</h3>
						<p>Route 1<br>Route 2<br>Route 3<br>Route 4</p>
					</div>
					
				</div>
			</div>
			<div class="forum-right">
				<div class="forum-topic-card">
					<h3>About</h3>
					<div class="details">
						<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed libero neque, aliquet in leo non, semper condimentum augue. Praesent vel sagittis elit. Maecenas eget nibh eu diam mattis tristique sed sed lacus. Praesent interdum convallis odio a iaculis. Duis luctus mi non enim dapibus mollis. Integer pharetra mollis nisi, ac malesuada nisl sollicitudin ut.</p>
					</div>
				</div>
				<div class="forum-topic-card">
					<div class="favourite-activities">
						<h3>History</h3>
						<p>Route 1<br>Route 2<br>Route 3<br>Route 4</p>
					</div>
					
				</div>
				<div class="forum-topic-card">
					<div class="favourite-activities">
						<h3>Achievements</h3>
						<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed libero neque, aliquet in leo non, semper condimentum augue. Praesent vel sagittis elit. Maecenas eget nibh eu diam mattis tristique sed sed lacus. Praesent interdum convallis odio a iaculis. Duis luctus mi non enim dapibus mollis. Integer pharetra mollis nisi, ac malesuada nisl sollicitudin ut. Duis sollicitudin sapien eget tincidunt ultrices. In nec elit lectus. Etiam maximus eu dui in blandit. Praese</p>
					</div>
					
				</div>
			</div>
		</div> -->
<!--SearchBox Section-->
<!--<div class="search-box">
	<div>
		<select name="" id="">
			<option value="Everything">Everything</option>
			<option value="Titles">Titles</option>
			<option value="Descriptions">Descriptions</option>
		</select> 
		<input type="text" name="q" placeholder="search ...">
		<button><i class="fa fa-search"></i></button>
	</div>
</div>-->
</header>
<div class="container">
	<div class="subforum">
		<div class="subforum-title">
			<a href="/subtopic/{{subtopic.id}}"><h1>{{subtopic.title}}</h1></a>
            <a href="/topic/{{maintopic.id}}" class="btn btn-secondary me-2" style="background-color:#B3C890 ;">Back to {{maintopic.title}}</a>
			{% if user.is_authenticated %}
            <a href="/createPost/{{subtopic.id}}" class="btn btn-secondary me-2" style="background-color:#B3C890 ; " >Create Post</a>
			{% endif %}
			<a href="/subtopic/{{subtopic.id}}" class="btn btn-secondary me-2" style="background-color:#B3C890 ;" >Clear Search</a>
		</div>
		<div style=" width: 100%; height: 100px; padding:20px" >
			<form action="/searchPost/" method="post">
			{% csrf_token %}
			<div class="row justify-content-between align-items-center" >
				<input type="text" name="search" placeholder="Search by title" style="border-radius: 40px; margin: auto; width:500px; height:60px;text-align: center;">
				<input type="hidden" name="id" value="{{subtopic.id}}">		
			</div>
			<div class="row justify-content-between align-items-center" >
				<button type="submit" style="border-radius: 40px; margin: auto; width:300px; height:40px;text-align: center;margin-top:10px; background-color:#B3C890;">Search</button>
			</div>
			</form>
			
		</div>
		<br>
		<br>
		<div class="subforum-title">
			<h1>All Posts</h1>
		</div>
		{% for post in posts %}
		<div class="subforum-row">
			<!-- <div class="subforum-icon subforum-column center">
			</div> -->
			<div class="subforum-description subforum-column">
				<a href="/viewPost/{{post.id}}"><h4>{{post.title}}</h4></a>
				{% if post.date %}
				Posted on: {{post.date}}
				{% endif %}
				<p>
					<a href="/forum/">{{post.topic.mainTopic.section}}</a> >
					<a href="/topic/{{post.topic.mainTopic.id}}">{{post.topic.mainTopic}}</a> >
                    <a href="/subtopic/{{post.topic.id}}">{{post.topic}}</a> >
					<a href="/viewPost/{{post.id}}">{{post.title}}</a><br>
					Tags: 
					{% for tag in post.tags.all %} 
					<a href="tags/{{tag.id}}">#{{tag}}</a>&nbsp;&nbsp;{% if user.is_authenticated %}&nbsp;<a href="/removeTagsForPost/{{post.id}}/{{tag.id}}" title="Remove tag #{{tag}}"><u>X</u></a>&nbsp;,&nbsp;&nbsp;{% endif %}
					{% endfor %}
					<br><br>Content: <br> {{post.text|safe}}
				</p>
                {% if post.image and post.image != 'False'%}
                <img src="{{post.image.url}}" alt="Image" style="max-width: 100%;max-height: 100%;">
                {% endif %}
				<p>
					<table style="text-align: center;" id="reactions">
						{% if user.is_authenticated%}
						<tr>
							{% if user in post.likeReactions.all %}
							<th style="background-color: #F5F0BB; "><a href="/removeReactPost/{{post.id}}/1/" title="Remove Like">&#128077</a></th>
							{% else %}
							<th><a href="/reactPost/{{post.id}}/1/" title="React Like">&#128077</a></th>
							{% endif %}
	
							{% if user in post.laughReactions.all %}
							<th style="background-color: #F5F0BB;"><a href="/removeReactPost/{{post.id}}/2/" title="Remove Laugh">&#128514</a></th>
							{% else %}
							<th><a href="/reactPost/{{post.id}}/2/" title="React Laugh">&#128514</a></th>
							{% endif %}
	
							{% if user in post.loveReactions.all %}
							<th style="background-color: #F5F0BB;"><a href="/removeReactPost/{{post.id}}/3/" title="Remove Love">&#128525</a></th>
							{% else %}
							<th><a href="/reactPost/{{post.id}}/3/" title="React Love">&#128525</a></th>
							{% endif %}
	
							{% if user in post.angryReactions.all %}
							<th style="background-color: #F5F0BB;"><a href="/removeReactPost/{{post.id}}/4/" title="Remove Angry">&#128545</a></th>
							{% else %}
							<th><a href="/reactPost/{{post.id}}/4/" title="React Angry">&#128545</a></th>
							{% endif %}
	
							{% if user in post.scareReactions.all %}
							<th style="background-color: #F5F0BB;"><a href="/removeReactPost/{{post.id}}/5/" title="Remove Scare">&#128561</a></th>
							{% else %}
							<th><a href="/reactPost/{{post.id}}/5/" title="React Scare">&#128561</a></th>
							{% endif %}
	
							{% if user in post.cryReactions.all %}
							<th style="background-color: #F5F0BB;"><a href="/removeReactPost/{{post.id}}/6/" title="Remove Cry">&#128557</a></th>
							{% else %}
							<th><a href="/reactPost/{{post.id}}/6/" title="React Cry">&#128557</a></th>
							{% endif %}
						</tr>
						{% else %}
						<tr>
							<th>&#128077</th>
							<th>&#128514</th>
							<th>&#128525</th>
							<th>&#128545</th>
							<th>&#128561</th>
							<th>&#128557</th>
						</tr>
						{% endif %}
						<tr>
							<td >{{post.likeCount}}</td>
							<td>{{post.laughCount}}</td>
							<td>{{post.loveCount}}</td>
							<td>{{post.angryCount}}</td>
							<td>{{post.scareCount}}</td>
							<td>{{post.cryCount}}</td>
						</tr>
					</table>
				</p>
			</div>
            <div class="subforum-stats subforum-column center">
				{% if post in user.posts.all or user.account.is_admin %}
                <a href="/deletePost/{{post.id}}">Delete Post</a>
                {% endif %}
				
			</div>
			<div class="subforum-info subforum-column">
				<span>Posted By <a href="/viewProfile/{{post.user.id}}">{{post.user}}</a></span>
				<br><span>Total Views: {{post.totalView}}</span> <br>
				{% if user.account.is_admin %}
					{% if post in allFP %}
						<br><b>Post Flagged, Please Check!</b>
					{% else %}
						<br><b>Post is normal, not flagged!</b>
					{% endif %}
				{% else %}
					{% if user.is_authenticated %}
						{% if post in flaggedPosts %}
							<br><b>Post Flagged and in Investigation</b>
						{% else %}
							<br><a href="/flagPost/{{post.id}}">Flag Post As Inappropriate</a>
						{% endif %}
					{% endif %}
				{% endif %}
			</div>
		</div>
		<hr class="subforum-devider">
		{% endfor %}


		{% if user.is_authenticated %}
		<div>
			<br><br>
			<div class="subforum-title">
				<h1>All Drafts</h1>
			</div>
			
			{% for draft in user.drafts.all %}
			<div class="subforum-row">
				<!-- <div class="subforum-icon subforum-column center">
				</div> -->
				<div class="subforum-description subforum-column">
					<h4>{{draft.title}}</h4>
					<p>
						<a href="/forum/">{{draft.topic.mainTopic.section}}</a> >
						<a href="/topic/{{post.topic.mainTopic.id}}">{{draft.topic.mainTopic}}</a> >
						<a href="/subtopic/{{post.topic.id}}">{{draft.topic}}</a> >
						<b>This Draft</b> <br>
						Content: <br> {{draft.text|safe}}
					</p>
					{% if draft.image and draft.image != 'False'%}
					<img src="{{draft.image.url}}" alt="Image" style="max-width: 100%;max-height: 100%;">
					{% endif %}
				</div>
				<div class="subforum-stats subforum-column center">
					<a href="/editDraft/{{draft.id}}">Edit Draft</a>
					
				</div>
				<div class="subforum-info subforum-column center">
					<a href="/deleteDraft/{{draft.id}}">Delete Draft</a>
				</div>
			</div>
			<hr class="subforum-devider">
			{% endfor %}
		</div>
		{% endif %}
	</div>
	<!--More-->
<!---->
</div>

<!-- Forum Info -->
<!--<div class="forum-info">
<div class="chart">
	MyForum - Stats &nbsp;<i class="fa fa-bar-chart"></i>
</div>
<span><u>5,369</u> Posts in <u>48</u> Topics by <u>8,124</u> Members.</span><br>
<span>Latest post: <b><a href="">Random post</a></b> on Dec 15 2021 By <a href="">RandomUser</a></span>.<br>
<span>Check <a href="">the latest posts</a> .</span><br>
</div>-->
		<!-- End forum -->

		<!-- Start Footer Section -->
		<footer class="footer-section">
			<div class="container relative">
				<div class="row g-5 mb-5">
					<div class="col-lg-4">
						<div class="mb-4 footer-logo-wrap"><a href="#" class="footer-logo">GoClimb<span>.</span></a></div>
						<p class="mb-4">Where Climbing meets peak</p>
					</div>

					<div class="col-lg-8">
						<div class="row links-wrap">
							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="/home">Home</a></li>
									<li><a href="/forum">Forum</a></li>
									<li><a href="/contact">Contact us</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="/weather">Weather</a></li>
									<li><a href="/ARroute">AR Route</a></li>
									<li><a href="/search">Search Crags</a></li>
								</ul>
							</div>

							<div class="col-6 col-sm-6 col-md-3">
								<ul class="list-unstyled">
									<li><a href="/profile">Profile</a></li>
									<li><a href="/notifications">Notifications</a></li>
								</ul>
							</div>
						</div>
					</div>
				</div>
			</div>
		</footer>
		<!-- End Footer Section -->	

		<script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'></script>
		<script>
			function copyToClipboard(text) {
				const textarea = document.createElement('textarea');
				textarea.value = text;
				document.body.appendChild(textarea);
				textarea.select();
				document.execCommand('copy');
				document.body.removeChild(textarea);
			}
			
			document.addEventListener('DOMContentLoaded', function() {
				const shareButtons = document.querySelectorAll('.share-button');
			
				shareButtons.forEach(button => {
					button.addEventListener('click', function() {
						const subtopicLink =  window.location.origin + this.getAttribute('data-subtopic-link');
						copyToClipboard(subtopicLink);
						alert('Link copied to clipboard!');
					});
				});
			});
		</script>
		<script src="{% static 'js/bootstrap.bundle.min.js'%}"></script>
		<!--<script src="{% static 'js/tiny-slider.js'%}"></script>-->
		<script src="{% static 'js/custom.js'%}"></script>
		<script src="{% static 'js/forum.js' %}"></script>
	</body>

</html>
